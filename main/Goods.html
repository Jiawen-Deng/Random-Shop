<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product Management</title>
</head>
<body>
    <h1>Product List</h1>
    <table border="1">
        <thead>
            <tr>
                <th>GID</th>
                <th>GName</th>
                <th>GDesc</th>
                <th>GValue</th>
                <th>GPic</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="productList">
            <!-- Products will be listed here -->
        </tbody>
    </table>

    <h2>Add or Update Product</h2>
    <form id="productForm">
        <input type="hidden" id="gid" name="gid">
        <label for="gname">GName:</label>
        <input type="text" id="gname" name="gname"><br><br>
        <label for="gdesc">GDesc:</label>
        <input type="text" id="gdesc" name="gdesc"><br><br>
        <label for="gvalue">GValue:</label>
        <input type="number" id="gvalue" name="gvalue"><br><br>
        <label for="gpic">GPic:</label>
        <input type="text" id="gpic" name="gpic"><br><br>
        <button type="submit">Submit</button>
    </form>

    <script>
        function loadProducts() {
            fetch('/api/products')
                .then(response => response.json())
                .then(data => {
                    const table = document.getElementById('productList');
                    table.innerHTML = '';
                    data.forEach(product => {
                        const row = `<tr>
                            <td>${product.gid}</td>
                            <td contenteditable="true" class="editable">${product.gname}</td>
                            <td contenteditable="true" class="editable">${product.gdesc}</td>
                            <td contenteditable="true" class="editable">${product.gvalue}</td>
                            <td contenteditable="true" class="editable">${product.gpic}</td>
                            <td><button onclick="editProduct(${product.gid})">Edit</button>
                                <button onclick="deleteProduct(${product.gid})">Delete</button></td>
                        </tr>`;
                        table.innerHTML += row;
                    });
                });
        }

        function editProduct(gid) {
            const gname = document.querySelector(`tr:nth-child(${gid}) .editable:nth-child(1)`).textContent;
            const gdesc = document.querySelector(`tr:nth-child(${gid}) .editable:nth-child(2)`).textContent;
            const gvalue = document.querySelector(`tr:nth-child(${gid}) .editable:nth-child(3)`).textContent;
            const gpic = document.querySelector(`tr:nth-child(${gid}) .editable:nth-child(4)`).textContent;
            document.getElementById('gid').value = gid;
            document.getElementById('gname').value = gname;
            document.getElementById('gdesc').value = gdesc;
            document.getElementById('gvalue').value = gvalue;
            document.getElementById('gpic').value = gpic;
        }

        function deleteProduct(gid) {
            fetch(`/api/products/${gid}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => loadProducts());
        }

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const gid = document.getElementById('gid').value;
            const url = gid ? `/api/products/${gid}` : '/api/products';
            const method = gid ? 'PUT' : 'POST';
            fetch(url, {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    gid: gid,
                    gname: document.getElementById('gname').value,
                    gdesc: document.getElementById('gdesc').value,
                    gvalue: document.getElementById('gvalue').value,
                    gpic: document.getElementById('gpic').value
                })
            })
            .then(response => response.json())
            .then(data => {
                if (method === 'POST') {
                    loadProducts();
                } else {
                    window.location.reload();
                }
            });
        });

        window.onload = loadProducts;
    </script>
</body>
</html>